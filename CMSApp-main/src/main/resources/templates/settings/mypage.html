<!DOCTYPE html>
<html lang="zxx" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AdminLTE 3 | Dashboard</title>

	<th:block th:replace="~{fragments/header_link :: header_link}"/>
	<th:block th:replace="~{elements/datatables_header_link :: datatables_header_link}"/>
	<th:block th:replace="~{elements/advanced_forms_header_link :: advanced_forms_header_link}"/>
	
	 <style>
	 		
		input[type="file"] {
		    display: none;
		}
		
		.inputFileButton {
		    padding: 6px 25px;
			background-color:#FFFFFF;
		    border-radius: 4px;
		    color: black;
		    cursor: pointer;
		    display: inline-block;
		    margin: 15px auto;  /* 세로 여백과 자동 가로 중앙 정렬 */
		    text-align: center; /* 버튼 내 텍스트 중앙 정렬 */
		}
	 
        .addImage {
            width: 45%;
            height: 45%;
            background-color: lightgray;
            border-radius: 20px 20px / 20px 20px;
            overflow: hidden;
            display: flex;
	        justify-content: center; /* 수평 가운데 정렬 */
	        align-items: center; /* 수직 가운데 정렬 */
        }
        .addImage img {
        	width: 100%;
        	height: 100%;	        
	        max-width: 100%; /* 이미지가 부모 요소를 넘지 않도록 최대 크기 지정 */
	        max-height: 100%;
	        object-fit: cover;
	    }
    </style>

</head>
<body class="hold-transition sidebar-mini layout-fixed">
<div class="wrapper">

  <!-- Preloader -->
  <th:block th:replace="~{fragments/preloader :: preloader}"/>
	
  <!-- Navbar -->
	<th:block th:replace="~{fragments/navi :: navi}"/>
  <!-- /.navbar -->

  <!-- Main Sidebar Container -->
  <th:block th:replace="~{fragments/sidebar :: sidebar}"/>
  <!-- /.sidebar -->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0" style="font-weight: bold;">계정 정보 변경</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a th:href="@{general}">Settings</a></li>
              <li class="breadcrumb-item active">Mypage</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <h6 style="color: gray; margin-left: 50px; margin-bottom: 20px;">나의 정보를 변경할 수 있습니다.</h6>
    <section class="content">
      	<div class="container-fluid">
    		<div class="row">
    			<div class="col-md-12">
				    <div class="card">
				        <div class="card-header p-2">
				            <ul class="nav nav-pills">
				                <li class="nav-item"><a class="nav-link active" href="#settings" data-toggle="tab">Settings</a></li>
				                <li class="nav-item"><a class="nav-link" href="#timeline" data-toggle="tab">Timeline</a></li>
				            </ul>
				        </div>
				        <div class="card-body">
				            <div class="tab-content">
				
				                <div class="tab-pane" id="timeline">
				
				                    <div class="timeline timeline-inverse">
				
				                        <div class="time-label">
				                            <span class="bg-danger">
				                                10 Feb. 2014
				                            </span>
				                        </div>
				
				
				                        <div>
				                            <i class="fas fa-envelope bg-primary"></i>
				                            <div class="timeline-item">
				                                <span class="time"><i class="far fa-clock"></i> 12:05</span>
				                                <h3 class="timeline-header"><a href="#">Support Team</a> sent you an email</h3>
				                                <div class="timeline-body">
				                                    Etsy doostang zoodles disqus groupon greplin oooj voxy zoodles,
				                                    weebly ning heekya handango imeem plugg dopplr jibjab, movity
				                                    jajah plickers sifteo edmodo ifttt zimbra. Babblely odeo kaboodle
				                                    quora plaxo ideeli hulu weebly balihoo...
				                                </div>
				                                <div class="timeline-footer">
				                                    <a href="#" class="btn btn-primary btn-sm">Read more</a>
				                                    <a href="#" class="btn btn-danger btn-sm">Delete</a>
				                                </div>
				                            </div>
				                        </div>
				
				
				                        <div>
				                            <i class="fas fa-user bg-info"></i>
				                            <div class="timeline-item">
				                                <span class="time"><i class="far fa-clock"></i> 5 mins ago</span>
				                                <h3 class="timeline-header border-0"><a href="#">Sarah Young</a> accepted your friend
				                                    request
				                                </h3>
				                            </div>
				                        </div>
				
				
				                        <div>
				                            <i class="fas fa-comments bg-warning"></i>
				                            <div class="timeline-item">
				                                <span class="time"><i class="far fa-clock"></i> 27 mins ago</span>
				                                <h3 class="timeline-header"><a href="#">Jay White</a> commented on your post</h3>
				                                <div class="timeline-body">
				                                    Take me to your leader!
				                                    Switzerland is small and neutral!
				                                    We are more like Germany, ambitious and misunderstood!
				                                </div>
				                                <div class="timeline-footer">
				                                    <a href="#" class="btn btn-warning btn-flat btn-sm">View comment</a>
				                                </div>
				                            </div>
				                        </div>
				
				
				                        <div class="time-label">
				                            <span class="bg-success">
				                                3 Jan. 2014
				                            </span>
				                        </div>
				
				
				                        <div>
				                            <i class="fas fa-camera bg-purple"></i>
				                            <div class="timeline-item">
				                                <span class="time"><i class="far fa-clock"></i> 2 days ago</span>
				                                <h3 class="timeline-header"><a href="#">Mina Lee</a> uploaded new photos</h3>
				                                <div class="timeline-body">
				                                    <img src="https://placehold.it/150x100" alt="...">
				                                    <img src="https://placehold.it/150x100" alt="...">
				                                    <img src="https://placehold.it/150x100" alt="...">
				                                    <img src="https://placehold.it/150x100" alt="...">
				                                </div>
				                            </div>
				                        </div>
				
				                        <div>
				                            <i class="far fa-clock bg-gray"></i>
				                        </div>
				                    </div>
				                </div>
								
				                <div class="tab-pane active" id="settings">
				                    <form class="form-horizontal" id="emp_account">
				                    	<input type="hidden" id="emp_idx" name="emp_idx" th:value="${emp.emp_idx}">
				                        <div class="form-group row">
				                            <label for="inputName" class="col-sm-2 col-form-label">Name</label>
				                            <div class="col-sm-10">
				                                <input type="text" th:value="${emp.getEmp_name}" class="form-control" name="emp_name">
				                            </div>
				                        </div>
				                        <div class="form-group row">
				                            <label for="inputID" class="col-sm-2 col-form-label">ID</label>
				                            <div class="col-sm-10">
				                                <input type="text" th:value
				                                ="${empDetail.getEmp_id}" class="form-control" name="emp_id">
				                            </div>
				                        </div>
				                        <div class="form-group row">
				                            <label for="inputPW" class="col-sm-2 col-form-label">PW</label>
				                            <div class="col-sm-10">
				                                <input type="password" th:value="${empDetail.getEmp_pw}" class="form-control" name="emp_pw">
				                            </div>
				                        </div>
				                        <div class="form-group row">
				                            <label for="inputDepartment" class="col-sm-2 col-form-label">Department</label>
				                            <div class="col-sm-10">
				                                <div class="form-group">
				                                	<select id="input_dept_idx" name="dept_idx" class="select1 form-control" data-placeholder="부서 선택" style="width: 100%;" disabled="disabled">
														<!-- 부서 이동 권한은 사용자에게는 없고, 관리자에게만 출력 (disabled) -->
														<option th:each="dept : ${deptList}" th:value="${dept.dept_idx}" th:text="${dept.dept_name}" th:selected="${dept}==${emp.dept}"></option>
													</select>
										        </div>
				                            </div>
				                        </div>
				                        <div class="form-group row">
				                            <label for="inputRole" class="col-sm-2 col-form-label">Role</label>
				                            <div class="col-sm-10">
									            <div class="form-group">
									            	<select id="input_role_code" name="role_code" class="select1 form-control" data-placeholder="역할 선택" style="width: 100%;" disabled="disabled">
														<!-- 역할 변경 권한은 사용자에게는 없고, 관리자에게만 출력 (disabled) -->
														<option th:each="role : ${roleList}" th:value="${role.role_code}" th:text="${role.role_name}" th:selected="${role}==${emp.role}"></option>
													</select>
									            </div> 
				                            </div>
				                        </div>
				                        <div class="form-group row">
							                <label for="inputImage" class="col-sm-2 col-form-label">Profile Image</label>
						                	<div class="col-sm-8 row">
									        	<div class="col">
										            <div class="form-group">
											            <div class="addImage" id="image-show" style="width: 200px; height: 200px;">
										                 	<img th:src="${profile_img_url}" alt="Profile Image" id="profileImg">
										                </div>
										                <label class="inputFileButton" for="inputFile">
										                	이미지 첨부
										                </label>
														<input type="file" name="file" id="inputfile" accept="image/*" onchange="loadFile(this)" style="margin-top: 15px; display: block;">
					                				</div>
					                			</div>
						                	</div>
							            </div>
				                        <div class="form-group">
			                                <button type="button" id="update_emp_account" class="btn btn-success float-right" style="height: 38px">Save Changes</button>
				                        </div>
				                    </form>
				                </div>
				
				            </div>
				
				        </div>
				    </div>
				
				</div>
    		</div>
   		</div>  	
  	</section>
  <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  
  <th:block th:replace="~{fragments/footer :: footer}"/>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->
  
	
  <th:block th:replace="~{fragments/footer_link :: footer_link}"/>
  <th:block th:replace="~{elements/datatables_footer_link :: datatables_footer_link}"/>
  <th:block th:replace="~{elements/advanced_forms_footer_link :: advanced_forms_footer_link}"/>

  <!-- 사이드바 디렉토리 관련 로직 -->
  <th:block th:replace="~{elements/sidebar_script :: sidebar_script}"/>
  <!-- /.사이드바 디렉토리 관련 로직 -->
</body>
</html>
<script type="text/javascript">

	function updateEmpAccount() {
		$("#emp_account").attr({
			action:"/settings/mypage/update",
			method:"post",
			// 텍스트 데이터와 바이너리 데이터가 섞여 있는 복합 데이터 전송: enctype multipart/form-data
			enctype:"multipart/form-data"
		});
		$("#emp_account").submit();
		
	}
	
	$(function(){
		$("#update_emp_account").click(function(){
			// disable된 값은 넘어가지 않기에 속성을 변경해준다
			$("select[name=dept_idx]").removeAttr('disabled');
			$("select[name=role_code]").removeAttr('disabled');
			updateEmpAccount();
		});		
	});
	
</script>